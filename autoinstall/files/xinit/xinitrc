#!/bin/bash
# Purple Computer X11 Startup Script
# This launches when the purple user logs in and starts X11

# Disable screen blanking and power management
xset s off
xset -dpms
xset s noblank

# Disable bell
xset b off

# Set keyboard repeat rate (faster for kid typing)
xset r rate 300 30

# Hide mouse cursor after 2 seconds of inactivity
# (kids often don't use mouse in terminal)
if command -v unclutter &> /dev/null; then
    unclutter -idle 2 &
fi

# Set the purple background color (brand identity - fills screen outside 10Ã—6" viewport)
xsetroot -solid "#2d1b4e"

# Launch matchbox window manager (minimal WM for proper fullscreen support)
matchbox-window-manager &

# Dev mode: Use /mnt/purple if mounted (for VM development)
# Production: Use /home/purple/.purple (for standalone installations)
if [ -d /mnt/purple/purple_tui ] && [ -f /mnt/purple/purple_tui/purple_tui.py ]; then
    PURPLE_PATH="/mnt/purple/purple_tui/purple_tui.py"
else
    PURPLE_PATH="/home/purple/.purple/purple_tui.py"
fi

# Launch Alacritty in fullscreen with Purple Computer Textual TUI
exec alacritty --config-file /home/purple/.config/alacritty/alacritty.toml \
    -e "$PURPLE_PATH"
